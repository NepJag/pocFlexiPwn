title: Generic Privilege Escalation Detection
id: privesc-generic-001
status: stable
description: Detecta múltiples vectores de escalación de privilegios
author: Dylan Riquelme
date: 2025-01-15

targets:
  # Archivos sensibles del sistema (paths reales del contenedor)
  - path: "/etc/passwd"
    events: ["MODIFY", "MOVED_TO"]
    description: "Modificación del archivo de usuarios del sistema"

  - path: "/etc/shadow"
    events: ["MODIFY", "MOVED_TO"]
    description: "Acceso al archivo de contraseñas hasheadas"

  # Directorio root - cualquier archivo de texto
  - path: "/root/"
    events: ["CREATE", "MODIFY", "MOVED_TO"]
    pattern: "*.txt"
    description: "Escritura de archivo .txt en directorio de root"

  # SSH keys para persistencia
  - path: "/root/.ssh/authorized_keys"
    events: ["CREATE", "MODIFY", "MOVED_TO"]
    description: "Modificación de claves SSH autorizadas"

# Condición: cualquiera es suficiente
condition: any

level: critical